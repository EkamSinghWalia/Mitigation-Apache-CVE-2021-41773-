############################################################################
# Mitigation script for CVE-2021-41773                                     #
# By: Ekam Singh Walia                                                     #
############################################################################



# Method 1: Update system repositories
sudo apt update && sudo apt upgrade -y #Update system repositories
apache2 -v # Check the currently running version of the Apache server
sudo add-apt-repository ppa:ondrej/apache2 -y && sudo apt update #  Add Apache PPA
sudo apt install apache2 # Upon adding the Apache PPA, install Apache from the new repositories.
apache2 -v


# Method 2: Set restrictions in apache2.conf file
a=$(cat /etc/apache2/apache2.conf | grep -A 2 -B 1 "Options FollowSymLinks" | grep "granted" | grep -o "granted")

if [[ "$a" == "granted" ]]
then
        sed -i '0,/granted/s//denied/' /etc/apache2/apache2.conf 
        echo "Mitigation process completed, you are safe from CVE-2021-41773 A Path Traversal And File Disclosure Vulnerability In Apache"
fi
